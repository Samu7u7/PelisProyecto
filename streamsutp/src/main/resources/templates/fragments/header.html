<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>

<div th:fragment="navbar">
    <style>
        /* Estilos para el menú de usuario (dropdown) parecido al diseño solicitado */
        .user-menu { background: rgba(12,14,18,0.85); backdrop-filter: blur(6px); border-radius: 12px; min-width: 220px; box-shadow: 0 10px 30px rgba(0,0,0,0.6); padding: 0.35rem; }
        .user-menu .dropdown-header { color: rgba(255,255,255,0.38); font-weight:700; font-size:0.75rem; padding: 0.45rem 0.9rem; }
        .user-menu .dropdown-item { color: #ffffff; font-weight:700; padding: 0.6rem 0.9rem; border-radius: 8px; }
        .user-menu .dropdown-item:hover { background: rgba(255,255,255,0.03); }
        .user-menu .dropdown-divider { margin: 0.35rem 0; }
        .navbar .dropdown-toggle { color: #fff; }
        .navbar .user-badge { display:flex; gap:0.5rem; align-items:center; }
        .navbar .user-badge .fa-user-circle { font-size:1.35rem; }
    </style>

    <header class="bg-dark text-white py-6">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark">
                <a class="navbar-brand fw-bold d-flex align-items-center" th:href="@{/}">
                    <img th:src="@{/imagenes/logo.png}" alt="Logo" style="height:34px; width:auto; margin-right:10px;" />
                    <span>StreamsUTP</span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item"><a class="nav-link" th:href="@{/}">INICIO</a></li>

                        <li class="nav-item" sec:authorize="isAnonymous()">
                                     <a th:href="@{/ingreso}"
                                         class="btn ms-2 d-inline-flex align-items-center"
                                         role="button"
                                         style="background: linear-gradient(180deg,#0d6efd,#0b5ed7); color:#ffffff; padding:0.45rem 0.95rem; border-radius:999px; font-weight:700; box-shadow: 0 6px 18px rgba(0,0,0,0.25); border: none;">
                                <i class="fa-solid fa-user me-2"></i> Iniciar sesión
                            </a>
                        </li>
                        <li class="nav-item" sec:authorize="isAnonymous()">
                                     <a th:href="@{/registro}"
                                         class="btn ms-2 d-inline-flex align-items-center"
                                         role="button"
                                         style="background: linear-gradient(180deg,#e50914,#b20710); color:#fff; padding:0.45rem 0.95rem; border-radius:999px; font-weight:700; box-shadow: 0 6px 18px rgba(0,0,0,0.25); border: none;">
                                SUSCRÍBETE
                            </a>
                        </li>
                        

                        <!-- Usuario autenticado: mostrar nombre y menú desplegable -->
                        <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                            <a class="nav-link dropdown-toggle user-badge" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fa-solid fa-user-circle"></i>
                                <span th:text="${#authentication.name}">Usuario</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end user-menu" aria-labelledby="userDropdown">
                                <li><h6 class="dropdown-header">MI CUENTA</h6></li>
                                <li><a class="dropdown-item" th:href="@{/perfil}">Mi perfil</a></li>
                                <li><a class="dropdown-item" th:href="@{/usuario/historial_ordenes}">Mis órdenes</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <form th:action="@{/logout}" method="post" style="margin:0;">
                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" th:if="${_csrf != null}" />
                                        <button type="submit" class="dropdown-item text-danger">Cerrar sesión</button>
                                    </form>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item" sec:authorize="hasRole('ADMIN')"><a class="nav-link" th:href="@{/admin/usuarios/lista}">ADMIN USUARIOS</a></li>
                        <li class="nav-item" sec:authorize="hasRole('ADMIN')"><a class="nav-link" th:href="@{/admin/ventas}">ADMIN VENTAS</a></li>

                        

                        
                        
                    </ul>
                </div>
            </nav>
        </div>
    </header>
</div>

</body>
</html>